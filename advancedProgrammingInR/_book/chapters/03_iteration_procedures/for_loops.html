<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>for loops | Advanced Programming in R</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
    

        
    
    
    <link rel="next" href="../../chapters/03_iteration_procedures/apply.html" />
    
    
    <link rel="prev" href="../../chapters/03_iteration_procedures/ITERATION_PROCEDURES.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="3.1" data-basepath="../.." data-revision="Thu Oct 08 2015 11:34:05 GMT+0200 (CEST)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="chapters/01_structured_workflow/STRUCTURED_WORKFLOW.html">
            
                
                    <a href="../../chapters/01_structured_workflow/STRUCTURED_WORKFLOW.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Towards a structured workflow
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="chapters/01_structured_workflow/projects.html">
            
                
                    <a href="../../chapters/01_structured_workflow/projects.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        RStudio projects
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="chapters/01_structured_workflow/version_control.html">
            
                
                    <a href="../../chapters/01_structured_workflow/version_control.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        GitHub version control
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="chapters/02_data_handling/DATA_HANDLING.html">
            
                
                    <a href="../../chapters/02_data_handling/DATA_HANDLING.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Data handling and visualization
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="chapters/02_data_handling/summarizing_data.html">
            
                
                    <a href="../../chapters/02_data_handling/summarizing_data.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Summarizing data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="chapters/02_data_handling/format_conversions.html">
            
                
                    <a href="../../chapters/02_data_handling/format_conversions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Data format conversions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="chapters/02_data_handling/visualization.html">
            
                
                    <a href="../../chapters/02_data_handling/visualization.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Visualizing data using ggplot2
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="chapters/03_iteration_procedures/ITERATION_PROCEDURES.html">
            
                
                    <a href="../../chapters/03_iteration_procedures/ITERATION_PROCEDURES.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Iteration procedures
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="3.1" data-path="chapters/03_iteration_procedures/for_loops.html">
            
                
                    <a href="../../chapters/03_iteration_procedures/for_loops.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        for loops
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="chapters/03_iteration_procedures/apply.html">
            
                
                    <a href="../../chapters/03_iteration_procedures/apply.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        The *apply family
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="chapters/03_iteration_procedures/functional_programming.html">
            
                
                    <a href="../../chapters/03_iteration_procedures/functional_programming.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Functional programming
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="chapters/04_speed_up/SPEED_UP.html">
            
                
                    <a href="../../chapters/04_speed_up/SPEED_UP.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Speeding up iteration procedures
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="chapters/04_speed_up/parallelization.html">
            
                
                    <a href="../../chapters/04_speed_up/parallelization.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Parallelization
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="chapters/04_speed_up/rcpp.html">
            
                
                    <a href="../../chapters/04_speed_up/rcpp.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        C++ interconnectivity via Rcpp
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="chapters/05_final_remarks/FINAL_REMARKS.html">
            
                
                    <a href="../../chapters/05_final_remarks/FINAL_REMARKS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Final remarks
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Advanced Programming in R</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="-for-loops"><em>for</em> loops</h1>
<p>Maybe the most important part of any advanced analysis workflow is to avoid (code) repetition. If you need to perform a certain task many times, propper interation structures are far more desirable than the classical copy and paste approach. </p>
<p>Why? Because they</p>
<ul>
<li>help you avoid errors (as each copy of any code chunk increases the risk of error introduction)</li>
<li>make debugging a lot easier as you only have to debug once</li>
<li>make your code a lot shorter and more readable</li>
<li>save you time coding</li>
<li>...</li>
</ul>
<p>The classical iteration structure is the so-called <em>for loop</em>. Classic, because it is the back-bone of any and all programming languages. The basic concept is simple</p>
<pre><code>for (a certain amount of iterations)
  do this
</code></pre><p>The way the iteration sequence is specified differs between languages, but the basic principle is always the same.</p>
<p>The sequence is usually specified via some placeholder - most popular of which is i for iteration - which usually represents an integer sequence, though you can also iterate over character strings. Here&apos;s a very simple loop:</p>
<pre><code class="lang-r"><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">5</span>) print(i)
</code></pre>
<pre><code>[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
</code></pre><p>Make sure you code clearly so that you can easily understand what your code is doing. Therefore, when using iteration structures, try to provide meaningful placeholder names.</p>
<pre><code class="lang-r"><span class="hljs-keyword">for</span> (name <span class="hljs-keyword">in</span> names(diamonds)) print(name)
</code></pre>
<pre><code>[1] &quot;carat&quot;
[1] &quot;cut&quot;
[1] &quot;color&quot;
[1] &quot;clarity&quot;
[1] &quot;depth&quot;
[1] &quot;table&quot;
[1] &quot;price&quot;
[1] &quot;x&quot;
[1] &quot;y&quot;
[1] &quot;z&quot;
</code></pre><p>Another way to specify an iteration is via the <code>seq()</code> function which can be used to create a sequence of integers based on the length of an object.</p>
<pre><code class="lang-r"><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> seq(names(diamonds))) cat(<span class="hljs-string">&quot;The class of colom&quot;</span>, i, <span class="hljs-string">&quot;is&quot;</span>,  class(diamonds[, i]), <span class="hljs-string">&quot;\n&quot;</span>)
</code></pre>
<pre><code>The class of colom 1 is numeric 
The class of colom 2 is ordered factor 
The class of colom 3 is ordered factor 
The class of colom 4 is ordered factor 
The class of colom 5 is numeric 
The class of colom 6 is numeric 
The class of colom 7 is integer 
The class of colom 8 is numeric 
The class of colom 9 is numeric 
The class of colom 10 is numeric
</code></pre><p>Did you spot the spelling mistake in the above example? It is easy to debug this, as we only need to correct the error once, not 10 times.</p>
<h3 id="task-1-looping-the-mean-meaning-the-loop">Task #1: Looping the mean, meaning the loop</h3>
<p>Take the above <code>for</code>-loop and modify so that instead of the class it prints out the mean of each column.</p>
<center>
  <img src="https://pixabay.com/static/uploads/photo/2012/04/14/14/04/hourglass-34048_640.png" alt="hourglass" style="width: 200px;">
</center>


<p>Obviously, we are usually not interested in simply printing something to the console (though this can be a great way of keeping track of where you&apos;re computation is in case of long running loops). Most of the time we want to actually run some computations/statistical analyses. The principle remains the same. </p>
<p>You may have heard the notion that <code>for</code>-loops in R are slow and should be avoided. This is true in many situations. As a general rule, </p>
<ul>
<li><strong>you should avoid <code>for</code>-loops whenever you want to do calculations on parts of an object. This can be achieved much more efficiently with indexing in R</strong></li>
<li><strong>if you have multiple objects and you want to carry out the same operation on each of them or you have one object and want to carry out different types of calculations on this same object, there is nothing wrong with using <code>for</code>-loops.</strong></li>
</ul>
<p>One common scenario is to work with different data sources. Here, <code>for</code>-loops can be quite useful. To highlight this, let&apos;s create a few data sources and save them to disk (we will load these again later).</p>
<p>Instead of reusing the same lines of code, we dynamically subset the data, build suitable names for saving and finally save each part of the data.</p>
<pre><code class="lang-r"><span class="hljs-comment">## index for start and end rows to be extracted</span>
indx_start &lt;- seq(<span class="hljs-number">1</span>, nrow(diamonds), <span class="hljs-number">2000</span>)
indx_end &lt;- c(indx_start[-<span class="hljs-number">1</span>] - <span class="hljs-number">1</span>, nrow(diamonds))

<span class="hljs-comment">## create new directory to save files to</span>
dir_nm &lt;- <span class="hljs-string">&quot;results&quot;</span>
dir.create(dir_nm, showWarnings = <span class="hljs-literal">FALSE</span>)

<span class="hljs-comment">## looping through the files</span>
<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> seq(indx_start)) {

  <span class="hljs-comment">## actual indeces for current iteration</span>
  st &lt;- indx_start[i]
  nd &lt;- indx_end[i]

  <span class="hljs-comment">## subset data based on row indeces</span>
  dat &lt;- diamonds[st:nd, ]

  <span class="hljs-comment">## create unique name for iteration data</span>
  nm &lt;- paste0(dir_nm, <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;diamonds_subset_&quot;</span>, 
               sprintf(<span class="hljs-string">&quot;%05.0f&quot;</span>, st), <span class="hljs-string">&quot;_&quot;</span>, 
               sprintf(<span class="hljs-string">&quot;%05.0f&quot;</span>, nd), <span class="hljs-string">&quot;.csv&quot;</span>)

  <span class="hljs-comment">## write to disk</span>
  write.csv(dat, nm, row.names = <span class="hljs-literal">FALSE</span>)
}
</code></pre>
<p><code>for</code>-loops are great for iterative operations that do not require assignment of their output to an object, e.g. the example above of saving data or producing plots. If we want the outcome of a loop to be assigned to an object and use this for further analysis, R has much more convenient structures which we will see in the next chapter.</p>
<p>Finally, there are more pieces related to iteration procedures in R:</p>
<ul>
<li><code>while</code>-loops to do semthing while some condition is met (e.g. while a certain value is below a certain threshold or thelike)</li>
<li><code>break</code> allows you to create a condition so that once it is met, the loop will stop</li>
<li><code>next</code> allows you to create a condition so that if it is met, the execution of the current iteration is skipped and the loop procedes to the next iteration without breaking the loop</li>
<li><code>if</code>-statements can also be helpful to prevent errors within loops</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../chapters/03_iteration_procedures/ITERATION_PROCEDURES.html" class="navigation navigation-prev " aria-label="Previous page: Iteration procedures"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../chapters/03_iteration_procedures/apply.html" class="navigation navigation-next " aria-label="Next page: The *apply family"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
